(function(t){function e(e){for(var s,c,r=e[0],o=e[1],l=e[2],f=0,d=[];f<r.length;f++)c=r[f],Object.prototype.hasOwnProperty.call(n,c)&&n[c]&&d.push(n[c][0]),n[c]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,r=1;r<a.length;r++){var o=a[r];0!==n[o]&&(s=!1)}s&&(i.splice(e--,1),t=c(c.s=a[0]))}return t}var s={},n={crew:0},i=[];function c(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=t,c.c=s,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(a,s,function(e){return t[e]}.bind(null,s));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/airbush5/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=o;i.push([0,"chunk-vendors","chunk-common"]),a()})({0:function(t,e,a){t.exports=a("5ba9")},"0621":function(t,e,a){"use strict";var s=a("370d"),n=a.n(s);n.a},"0770":function(t,e,a){},"0f0a":function(t,e,a){"use strict";var s=a("8b21"),n=a.n(s);n.a},"11ae":function(t,e,a){t.exports=a.p+"img/data_package_1.16f0e6ad.png"},"16f1":function(t,e,a){"use strict";var s=a("2075"),n=a.n(s);e["default"]=n.a},"197b":function(t,e,a){"use strict";var s=a("fc07"),n=a.n(s);n.a},1986:function(t,e,a){"use strict";var s=a("20b9"),n=a.n(s);n.a},"1bc7":function(t,e,a){"use strict";var s=a("8a7e"),n=a.n(s);n.a},2075:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh":{"title":"餐品列表"},"en":{"title":"Dish"}}'),delete t.options._Ctor}},"20b9":function(t,e,a){},"248f":function(t,e,a){t.exports=a.p+"img/data_package_3.e01ff050.png"},"370d":function(t,e,a){},"3f8cd":function(t,e,a){},"406e":function(t,e,a){"use strict";var s=a("3f8cd"),n=a.n(s);n.a},"477d":function(t,e,a){t.exports=a.p+"img/logo.6173e5c7.png"},"4b0b":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh":{},"en":{}}'),delete t.options._Ctor}},"54e9":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh":{},"en":{}}'),delete t.options._Ctor}},"571e":function(t,e,a){},"5ba9":function(t,e,a){"use strict";a.r(e);a("4de4"),a("4160"),a("c975"),a("b0c0"),a("159b"),a("e260"),a("e6cf"),a("cca65"),a("a79d");var s=a("2b0e"),n=a("3dfd"),i=a("2909"),c=a("8c4f"),r=a("162e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-login-ctn"},[a("div",{staticClass:"main-ctn"},[a("div",{staticClass:"top-ctn"},[a("div",{staticClass:"login-form-ctn"},[a("div",{staticClass:"form-field-ctn"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"field-input",attrs:{type:"text",placeholder:"User"},domProps:{value:t.userName},on:{input:function(e){e.target.composing||(t.userName=e.target.value)}}})])]),a("div",{staticClass:"login-form-ctn"},[a("div",{staticClass:"form-field-ctn"},[t._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.passWord,expression:"passWord"}],staticClass:"field-input",attrs:{type:"text",placeholder:"Password"},domProps:{value:t.passWord},on:{input:function(e){e.target.composing||(t.passWord=e.target.value)}}})])]),a("div",{staticClass:"login-btn",on:{click:t.login}},[t._v(" Login ")])]),t._m(2)])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon-ctn"},[a("i",{staticClass:"icon icon-user"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon-ctn"},[a("i",{staticClass:"icon icon-user"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bottom-ctn"},[s("img",{staticClass:"logo-img",attrs:{src:a("477d"),alt:""}})])}],u=a("d4ec"),f=a("bee2"),d=a("262e"),h=a("2caf"),v=a("9ab4"),p=a("60a3"),g=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.userName="",t.passWord="",t}return Object(f["a"])(a,[{key:"login",value:function(){this.userName?this.passWord?this.$router.push({name:"crewCatering"}):this.$toast("请输入密码"):this.$toast("请输入用户名")}}]),a}(p["c"]);g=Object(v["a"])([Object(p["a"])({name:"CrewLogin",components:{}})],g);var m=g,b=m,C=(a("0621"),a("2877")),y=a("16f1"),_=Object(C["a"])(b,o,l,!1,null,"c46f6406",null);"function"===typeof y["default"]&&Object(y["default"])(_);var k=_.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-layout-ctn"},[a("section",{staticClass:"header-ctn"},[a("crew-tab",{attrs:{tabList:t.tabList,active:t.active},on:{switchPage:t.switchPage}})],1),a("section",{staticClass:"body-ctn"},[a("router-view",{staticClass:"crew-route-view-ctn"})],1),a("section",{staticClass:"footer-ctn"},[a("crew-footer")],1),a("van-notify",{staticClass:"message-ctn",model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"notify-ctn"},[a("div",{staticClass:"notify-head"},[a("span",{staticClass:"tip"},[t._v(" You got a new message ")])]),a("div",{staticClass:"notify-content"},[a("div",{staticClass:"head-img"},[t._v(" Lzy ")]),a("div",{staticClass:"content-ctn"},[a("div",{staticClass:"seat-ctn"},[t._v("C21")]),a("div",{staticClass:"msg-ctn"},[t._v("我是消息的内容")])])])])])],1)},O=[],j=(a("ac1f"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"crew-tab"},t._l(t.tabList,(function(e,s){return a("div",{staticClass:"tab-item",class:{active:e.routeName==t.$route.name},on:{click:function(a){return t.switchPage(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0)}),S=[],L=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){return Object(u["a"])(this,a),e.apply(this,arguments)}return Object(f["a"])(a,[{key:"switchPage",value:function(t){this.$router.push({name:t.routeName})}}]),a}(p["c"]);Object(v["a"])([Object(p["b"])({default:function(){return[]}})],L.prototype,"tabList",void 0),Object(v["a"])([Object(p["b"])({default:function(){return!1}})],L.prototype,"active",void 0),L=Object(v["a"])([Object(p["a"])({name:"CrewTab",components:{}})],L);var I=L,M=I,T=(a("406e"),a("9b95")),N=Object(C["a"])(M,j,S,!1,null,"660d7e9e",null);"function"===typeof T["default"]&&Object(T["default"])(N);var U=N.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.flightResData?a("div",{staticClass:"crew-footer"},[a("div",{staticClass:"info-ctn first"},[a("i",{staticClass:"icon icon-crew-flight"}),a("span",{staticClass:"seat-number"},[t._v(" "+t._s(t.flightResData.Flight.Airplane.AirplaneModels)+" ")])]),a("div",{staticClass:"info-ctn second"},[a("i",{staticClass:"icon icon-location"}),a("span",{staticClass:"start-position"},[t._v(" "+t._s(t.flightResData.Flight.BaseInfo.Departure))]),a("span",[t._v("-")]),a("i",{staticClass:"icon icon-flight-horizatal"}),a("span",[t._v("-")]),a("span",{staticClass:"end-position"},[t._v(" "+t._s(t.flightResData.Flight.BaseInfo.Arrival))])]),a("div",{staticClass:"info-ctn third"},[a("i",{staticClass:"icon icon-time"}),a("span",{staticClass:"start-time"},[t._v(t._s(t._f("dateFormate")(t.flightResData.Flight.BaseInfo.DeparturePlanTimestamp,"hh:mm")))]),t._m(0),a("span",{staticClass:"end-time"},[t._v(t._s(t._f("dateFormate")(t.flightResData.Flight.BaseInfo.ArrivalPlanTimestamp,"hh:mm")))])]),a("div",{staticClass:"info-ctn fourth"},[a("i",{staticClass:"icon icon-weather"}),a("span",{staticClass:"temperature-ctn"},[t._v(" "+t._s(t.flightResData.Weather.Desc)+" "+t._s(t.flightResData.Weather.Temper)+" ")])])]):t._e()},A=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress-ctn"},[a("div",{staticClass:"progress"})])}],$=a("6883"),F=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.flightResData=null,t}return Object(f["a"])(a,[{key:"mounted",value:function(){this.getFlightInfo()}},{key:"getFlightInfo",value:function(){var t=this;$["a"].getFlightInfo().then((function(e){200==e.code&&(t.flightResData=e.data)}))}},{key:"switchPage",value:function(t){this.$emit("switchPage",t.value)}}]),a}(p["c"]);Object(v["a"])([Object(p["b"])({default:function(){return[]}})],F.prototype,"tabList",void 0),Object(v["a"])([Object(p["b"])({default:function(){return!1}})],F.prototype,"active",void 0),F=Object(v["a"])([Object(p["a"])({name:"crew-footer",components:{}})],F);var P=F,E=P,D=(a("0f0a"),a("7b52")),B=Object(C["a"])(E,x,A,!1,null,"1af0b6b9",null);"function"===typeof D["default"]&&Object(D["default"])(B);var z=B.exports,R=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.tabList=[{name:"Catering",value:"catering",routeName:"crewCatering"},{name:"Data package",value:"dataPackage",routeName:"crewDataPackage"},{name:"Goods",value:"goods",routeName:"crewGoods"},{name:"Income statistics",value:"incomeStatistics",routeName:"crewIncomeStatistics"},{name:"Cabin layout",value:"cabinLayout",routeName:"crewCabinLayout"}],t.active="catering",t.socket=null,t.show=!1,t}return Object(f["a"])(a,[{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){this.socket&&this.socket.close()}},{key:"startWebScoket",value:function(){var t=this,e={path:"VUE_APP_BASE_URL +'/websocket'"};this.socket=io(e);var a="4CFC4D33-2C1E-E911-BAD5-F44D307124C0";this.socket.on("connect",(function(){t.socket.emit("login",a)})),this.socket.on("new_msg",(function(e){var a=e.replace(/&quot;/g,'"'),s=JSON.parse(a);t.$globalEvent.$emit("new_msg",s),"system"==s.type&&t.showNotify()})),this.socket.on("saveNoticeList",(function(t){})),this.socket.on("saveChatList",(function(t){}))}},{key:"switchPage",value:function(t){this.active=t;var e={catering:"crewCatering",dataPackage:"crewDataPackage",goods:"crewGoods",incomeStatistics:"crewIncomeStatistics",cabinLayout:"crewCabinLayout"};e[t]&&this.$router.push({name:e[t]})}},{key:"showNotify",value:function(){var t=this;this.show=!0,setTimeout((function(){t.show=!1}),2e3)}}]),a}(p["c"]);R=Object(v["a"])([Object(p["a"])({name:"CrewLayoutCtn",components:{CrewTab:U,CrewFooter:z}})],R);var W=R,G=W,H=(a("1986"),Object(C["a"])(G,w,O,!1,null,"38106317",null)),V=H.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-catering"},[a("section",{staticClass:"top-ctn"},[a("crew-select",{attrs:{selectList:t.selectList,selectValue:t.status},on:{select:t.statusChange}}),a("crew-search",{on:{search:function(e){return t.search(e)}}})],1),a("section",{staticClass:"item-ctn"},[a("div",{staticClass:"item-ctt"},[a("van-pull-refresh",{on:{refresh:t.refreshList},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{ref:"mylist",attrs:{finished:t.finished,"finished-text":"没有更多了",offset:100,"immediate-check":!1},on:{load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("div",{staticClass:"catering-item-ctn"},t._l(t.dataList,(function(e,s){return a("crew-catering-item",{key:s,attrs:{data:e},on:{finish:function(e){return t.finishDish(e,s)}}})})),1)])],1)],1)])])},J=[],q=(a("99af"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-select"},[a("div",{staticClass:"select-value-ctn",on:{click:function(e){t.isShowed=!t.isShowed}}},[a("span",[t._v(t._s(t.selectLabel))]),a("i",{staticClass:"icon icon-caret"})]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowed,expression:"isShowed"}],staticClass:"dropdown-ctn"},t._l(t.selectList,(function(e,s){return a("div",{key:s,staticClass:"dropdown-item",on:{click:function(a){return t.select(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0)])}),K=[],Q=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.isShowed=!1,t.docClickHandle=function(){},t}return Object(f["a"])(a,[{key:"change",value:function(t){this.$emit("valueChange",t.value)}},{key:"created",value:function(){var t=this;this.docClickHandle=function(e){var a=e||window.event,s=t.closest(a.target,".crew-select");s||(t.isShowed=!1)},document.addEventListener("click",this.docClickHandle)}},{key:"beforeDestroy",value:function(){document.removeEventListener("click",this.docClickHandle)}},{key:"closest",value:function(t,e){var a=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;while(t){if(a.call(t,e))break;t=t.parentElement}return t}},{key:"select",value:function(t){this.isShowed=!1,this.$emit("select",t)}},{key:"selectLabel",get:function(){var t=this,e="未知";return this.selectList.forEach((function(a,s){t.selectValue==a.value&&(e=a.name)})),e}}]),a}(p["c"]);Object(v["a"])([Object(p["b"])({default:function(){return[]}})],Q.prototype,"selectList",void 0),Object(v["a"])([Object(p["b"])({default:function(){return""}})],Q.prototype,"selectValue",void 0),Q=Object(v["a"])([Object(p["a"])({name:"CrewTab",components:{}})],Q);var X=Q,Z=X,tt=(a("d084"),Object(C["a"])(Z,q,K,!1,null,"c098e5bc",null)),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"crew-search"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchWord,expression:"searchWord"}],attrs:{type:"text",placeholder:"Search for seat number"},domProps:{value:t.searchWord},on:{input:function(e){e.target.composing||(t.searchWord=e.target.value)}}}),a("button",{on:{click:function(e){return t.search()}}},[t._v("search")])])},st=[],nt=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.searchWord="",t}return Object(f["a"])(a,[{key:"search",value:function(){this.$emit("search",this.searchWord)}}]),a}(p["c"]);nt=Object(v["a"])([Object(p["a"])({name:"CrewSearch",components:{}})],nt);var it=nt,ct=it,rt=(a("8519"),Object(C["a"])(ct,at,st,!1,null,"f19d6778",null)),ot=rt.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-catering-item"},[a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+t.data.SampleImgPath+")"}}),a("div",{staticClass:"info-ctn"},[a("div",{staticClass:"info-left-ctn"},[a("div",{staticClass:"line-one"},[a("span",[t._v(t._s(t.data.Seat))]),a("span",[t._v("3min")])]),a("div",{staticClass:"line-two"},[t._v(t._s(t.data.Name))])]),a("div",{staticClass:"info-right-ctn"},[a("span",{staticClass:"price-ctn"},[t._v("$"+t._s(t.data.Price))]),"0"==t.data.status?a("span",{staticClass:"finish-ctn",on:{click:t.finish}},[t._v("Finish")]):t._e()])])])},ut=[],ft=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){return Object(u["a"])(this,a),e.apply(this,arguments)}return Object(f["a"])(a,[{key:"finish",value:function(){this.$emit("finish",this.data)}}]),a}(p["c"]);Object(v["a"])([Object(p["b"])()],ft.prototype,"data",void 0),ft=Object(v["a"])([Object(p["a"])({name:"CrewCateringItem",components:{}})],ft);var dt=ft,ht=dt,vt=(a("ce38"),Object(C["a"])(ht,lt,ut,!1,null,"08fd9678",null)),pt=vt.exports,gt=a("b32d"),mt=function(){function t(){Object(u["a"])(this,t)}return Object(f["a"])(t,null,[{key:"getDishOrderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Dishes/DishOrder",method:"POST",data:t})}},{key:"finishDishes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Dishes/Finish",method:"POST",data:t})}}]),t}(),bt=a("1788"),Ct=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.dataList=[],t.pageSize=12,t.pageNumber=1,t.refreshing=!1,t.loading=!1,t.finished=!1,t.status="0",t.seat="",t.selectList=[{name:"pending",value:"0"},{name:"finished",value:"1"}],t}return Object(f["a"])(a,[{key:"mounted",value:function(){this.resetList()}},{key:"search",value:function(t){this.seat=t,this.resetList()}},{key:"statusChange",value:function(t){this.status=t.value,this.resetList()}},{key:"loadList",value:function(){this.pageNumber=this.pageNumber+1,this.pageSize=12,this.getList()}},{key:"refreshList",value:function(){this.refreshing=!0,this.resetList()}},{key:"resetList",value:function(){this.pageNumber=1,this.pageSize=12,this.dataList=[],this.getList()}},{key:"getList",value:function(){var t=this;mt.getDishOrderList({take:this.pageSize,skip:(this.pageNumber-1)*this.pageSize,status:this.status,seat:this.seat}).then((function(e){"200"==e.code?(0==e.data.count||t.pageNumber*t.pageSize>e.data.count?t.finished=!0:t.finished=!1,e.data.data.forEach((function(t,e){t.BannerImgPath=bt["a"].addBaseUrl(bt["a"].delBaseUrl(t.BannerImgPath))})),t.dataList=t.dataList.concat(e.data.data),t.loading=!1,t.refreshing=!1):(t.$toast("获取列表失败!"),t.loading=!1,t.refreshing=!1)}))}},{key:"finishDish",value:function(t,e){var a=this;mt.finishDishes({id:t.id}).then((function(t){"200"==t.code&&(a.$toast("操作成功！"),a.dataList[e].status="2")}))}}]),a}(p["c"]);Ct=Object(v["a"])([Object(p["a"])({name:"CrewCatering",components:{CrewSelect:et,CrewSearch:ot,CrewCateringItem:pt}})],Ct);var yt=Ct,_t=yt,kt=(a("c8cf"),Object(C["a"])(_t,Y,J,!1,null,"eb23004e",null)),wt=kt.exports,Ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-catering"},[a("section",{staticClass:"top-ctn"},[a("crew-select",{staticStyle:{visibility:"hidden"},attrs:{selectList:t.selectList,selectValue:t.status},on:{select:t.statusChange}}),a("crew-search",{on:{search:function(e){return t.search(e)}}})],1),a("section",{staticClass:"item-ctn"},[a("div",{staticClass:"item-ctt"},[a("van-pull-refresh",{on:{refresh:t.refreshList},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{ref:"mylist",attrs:{finished:t.finished,"finished-text":"没有更多了",offset:100,"immediate-check":!1},on:{load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("div",{staticClass:"catering-item-ctn"},t._l(t.dataList,(function(t,e){return a("crew-data-package-item",{key:e,attrs:{data:t}})})),1)])],1)],1)])])},jt=[],St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-catering-item"},["ALL-DAY Pass"==t.data.Name?a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+t.imageMap[t.data.Name]+")"}},[t._v(" "+t._s(t.data.Name)+" ")]):t._e(),"1GB"==t.data.Name?a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+t.imageMap[t.data.Name]+")"}},[t._v(" "+t._s(t.data.Name)+" ")]):t._e(),"ALL-DAY Pass"!=t.data.Name&&"1GB"!=t.data.Name?a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+t.imageMap["50M"]+")"}},[t._v(" "+t._s(t.data.Name)+" ")]):t._e(),a("div",{staticClass:"info-ctn"},[a("div",{staticClass:"info-left-ctn"},[a("div",{staticClass:"line-one"},[a("span",[t._v(t._s(t.data.Seat))]),a("span",[t._v("3min")])]),a("div",{staticClass:"line-two"},[t._v(t._s(t.data.Name))])]),a("div",{staticClass:"info-right-ctn"},[a("span",{staticClass:"price-ctn"},[t._v("￥"+t._s(t.data.FinalPrice))])])])])},Lt=[],It=function(t){Object(d["a"])(s,t);var e=Object(h["a"])(s);function s(){var t;return Object(u["a"])(this,s),t=e.apply(this,arguments),t.imageMap={"ALL-DAY Pass":a("11ae"),"1GB":a("b6a6"),"50M":a("248f")},t}return Object(f["a"])(s,[{key:"finish",value:function(){this.$emit("finish",this.data)}}]),s}(p["c"]);Object(v["a"])([Object(p["b"])()],It.prototype,"data",void 0),It=Object(v["a"])([Object(p["a"])({name:"CrewDataPackageItem",components:{}})],It);var Mt=It,Tt=Mt,Nt=(a("f2bc"),Object(C["a"])(Tt,St,Lt,!1,null,"0de45053",null)),Ut=Nt.exports,xt=function(){function t(){Object(u["a"])(this,t)}return Object(f["a"])(t,null,[{key:"getNetFlowOrderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/NetFlow/NetFlowOrder",method:"POST",data:t})}}]),t}(),At=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.dataList=[],t.pageSize=12,t.pageNumber=1,t.refreshing=!1,t.loading=!1,t.finished=!1,t.status="0",t.seat="",t.selectList=[{name:"未完成",value:"0"},{name:"已完成",value:"1"}],t}return Object(f["a"])(a,[{key:"mounted",value:function(){this.resetList()}},{key:"search",value:function(t){this.seat=t,this.resetList()}},{key:"statusChange",value:function(t){this.status=t.value,this.resetList()}},{key:"loadList",value:function(){this.pageNumber=this.pageNumber+1,this.pageSize=12,this.getList()}},{key:"refreshList",value:function(){this.refreshing=!0,this.resetList()}},{key:"resetList",value:function(){this.pageNumber=1,this.pageSize=12,this.dataList=[],this.getList()}},{key:"getList",value:function(){var t=this;xt.getNetFlowOrderList({take:this.pageSize,skip:(this.pageNumber-1)*this.pageSize,status:this.status="3"}).then((function(e){"200"==e.code?(0==e.data.count||t.pageNumber*t.pageSize>e.data.count?t.finished=!0:t.finished=!1,e.data.data.forEach((function(t,e){t.BannerImgPath=bt["a"].addBaseUrl(bt["a"].delBaseUrl(t.BannerImgPath))})),t.dataList=t.dataList.concat(e.data.data),t.loading=!1,t.refreshing=!1):(t.$toast("获取列表失败!"),t.loading=!1,t.refreshing=!1)}))}}]),a}(p["c"]);At=Object(v["a"])([Object(p["a"])({name:"CrewCatering",components:{CrewSelect:et,CrewSearch:ot,CrewDataPackageItem:Ut}})],At);var $t=At,Ft=$t,Pt=(a("e76f"),Object(C["a"])(Ft,Ot,jt,!1,null,"052670f0",null)),Et=Pt.exports,Dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-catering"},[a("section",{staticClass:"top-ctn"},[a("crew-select",{staticStyle:{visibility:"hidden"},attrs:{selectList:t.selectList,selectValue:t.status},on:{select:t.statusChange}}),a("crew-search",{on:{search:function(e){return t.search(e)}}})],1),a("section",{staticClass:"item-ctn"},[a("div",{staticClass:"item-ctt"},[a("van-pull-refresh",{on:{refresh:t.refreshList},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{ref:"mylist",attrs:{finished:t.finished,"finished-text":"没有更多了",offset:100,"immediate-check":!1},on:{load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("div",{staticClass:"catering-item-ctn"},t._l(t.dataList,(function(t,e){return a("crew-catering-item",{key:e,attrs:{data:t}})})),1)])],1)],1)])])},Bt=[],zt=function(){function t(){Object(u["a"])(this,t)}return Object(f["a"])(t,null,[{key:"getShoppingOrderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Shopping/ShoppingOrder",method:"POST",data:t})}}]),t}(),Rt=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.dataList=[],t.pageSize=12,t.pageNumber=1,t.refreshing=!1,t.loading=!1,t.finished=!1,t.status="0",t.seat="",t.selectList=[{name:"未完成",value:"0"},{name:"已完成",value:"1"}],t}return Object(f["a"])(a,[{key:"mounted",value:function(){this.resetList()}},{key:"search",value:function(t){this.seat=t,this.resetList()}},{key:"statusChange",value:function(t){this.status=t.value,this.resetList()}},{key:"loadList",value:function(){this.pageNumber=this.pageNumber+1,this.pageSize=12,this.getList()}},{key:"refreshList",value:function(){this.refreshing=!0,this.resetList()}},{key:"resetList",value:function(){this.pageNumber=1,this.pageSize=12,this.dataList=[],this.getList()}},{key:"getList",value:function(){var t=this;zt.getShoppingOrderList({take:this.pageSize,skip:(this.pageNumber-1)*this.pageSize,seat:this.seat}).then((function(e){"200"==e.code?(0==e.data.count||t.pageNumber*t.pageSize>e.data.count?t.finished=!0:t.finished=!1,e.data.data.forEach((function(t,e){t.BannerImgPath=bt["a"].addBaseUrl(bt["a"].delBaseUrl(t.BannerImgPath))})),t.dataList=t.dataList.concat(e.data.data),t.loading=!1,t.refreshing=!1):(t.$toast("获取列表失败!"),t.loading=!1,t.refreshing=!1)}))}}]),a}(p["c"]);Rt=Object(v["a"])([Object(p["a"])({name:"CrewCatering",components:{CrewSelect:et,CrewSearch:ot,CrewCateringItem:pt}})],Rt);var Wt=Rt,Gt=Wt,Ht=(a("d7ed"),Object(C["a"])(Gt,Dt,Bt,!1,null,"6671cec7",null)),Vt=Ht.exports,Yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-income-statistics"},[a("div",{staticClass:"charts-statistic-ctn"},[a("crew-statistic-chart",{ref:"dishStatisticChart",attrs:{title:"Catering"}})],1),a("div",{staticClass:"charts-statistic-ctn"},[a("crew-statistic-chart",{ref:"netFlowStatisticChart",attrs:{title:"Data package",type:"dataPackage"}})],1),a("div",{staticClass:"charts-statistic-ctn"},[a("crew-statistic-chart",{ref:"shoppingStatisticChart",attrs:{title:"Goods"}})],1)])},Jt=[],qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"crew-statistic-chart"},[a("div",{staticClass:"charts-ctn"},[a("div",{ref:"pieCtn",staticClass:"pie-ctn"}),a("p",[t._v(" "+t._s(t.title)+" ")])]),a("div",{staticClass:"statistic-detail-ctn"},t._l(t.dataList,(function(e,s){return a("div",{key:s,staticClass:"detail-item"},["dataPackage"==t.type?a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+t.imageMap[e.Name]+")"}},[t._v(" "+t._s(e.Name)+" ")]):t._e(),"dataPackage"!=t.type?a("div",{staticClass:"img-ctn",style:{backgroundImage:"url("+e.SampleImgPath+")"}}):t._e(),a("div",{staticClass:"progress-ctn"},[a("div",{staticClass:"top-ctn"},[a("span",[t._v(t._s(e.Name))]),a("span",{staticClass:"dot"}),a("span",[t._v(t._s(e.getMoney))])]),a("div",{staticClass:"bottom-ctn"},[a("div",{staticClass:"progress-bar",style:{width:e.percent+"%",backgroundColor:t.colorArr[s]}}),a("div",{staticClass:"percent"},[t._v(" "+t._s(e.percent+"%")+" ")])])])])})),0)])},Kt=[],Qt=(a("a434"),a("a9e3"),a("b680"),a("313e")),Xt=a.n(Qt),Zt=function(t){Object(d["a"])(s,t);var e=Object(h["a"])(s);function s(){var t;return Object(u["a"])(this,s),t=e.apply(this,arguments),t.imageMap={"ALL-DAY Pass":a("11ae"),"1GB":a("b6a6"),"50MB":a("248f")},t.colorArr=["#00AEC7","#FE5000","#84BD00","#A51890","#E1E000","#DA1884","#E4002B","#0081FF","#0C9254","#6500D4"],t.dataList=[],t.chart={},t}return Object(f["a"])(s,[{key:"mounted",value:function(){this.chart=Xt.a.init(this.$refs.pieCtn)}},{key:"renderCharts",value:function(t){var e=[],a=0;t.forEach((function(t,e){t.getMoney=Number(t.getMoney),a+=t.getMoney})),t.forEach((function(t,s){e.push({name:t.Name,value:t.getMoney}),t.percent=(t.getMoney/a*100).toFixed(),t.SampleImgPath=bt["a"].addBaseUrl(bt["a"].delBaseUrl(t.SampleImgPath))})),this.dataList=t.splice(0,3),this.chart.clear();var s={title:{textStyle:{color:"#333333",fontSize:12}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)",textStyle:{color:"#fff",fontSize:10}},graphic:[{type:"text",top:"40%",left:"center",style:{text:a.toFixed(2),fill:"#A6A8B6",fontSize:20,fontWeight:"normal"}},{type:"text",top:"53%",left:"center",style:{text:"Total Revenuea",fill:"#A6A8B6",fontSize:12,fontWeight:"normal"}}],color:this.colorArr,legend:{selectedMode:!0,bottom:0,itemWidth:10,itemHeight:10,data:["基本工资","福利奖金","出差补贴","交补话补","岗位工资"],textStyle:{color:"#A6A8B6",fontSize:10}},series:[{name:"工资占比图",type:"pie",center:["50%","45%"],radius:["45%","60%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"left",formatter:"{a},{b}:{c}（{d}%）"},emphasis:{show:!1,textStyle:{fontSize:"12",fontWeight:"bold"}}},labelLine:{normal:{show:!1,length:10,length2:20}},itemStyle:{normal:{borderColor:"#FFFFFF",borderWidth:1,label:{show:!0,formatter:"{d}%"}}},data:e}]};this.chart.setOption(s)}}]),s}(p["c"]);Object(v["a"])([Object(p["b"])({default:function(){return""}})],Zt.prototype,"title",void 0),Object(v["a"])([Object(p["b"])({default:function(){return""}})],Zt.prototype,"type",void 0),Zt=Object(v["a"])([Object(p["a"])({name:"CrewStatisticChart",components:{}})],Zt);var te=Zt,ee=te,ae=(a("197b"),Object(C["a"])(ee,qt,Kt,!1,null,"1368b659",null)),se=ae.exports,ne=function(){function t(){Object(u["a"])(this,t)}return Object(f["a"])(t,null,[{key:"getAccountForDish",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Dishes/AccountForDish",method:"POST",data:t})}},{key:"getAccountForNetFlow",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/NetFlow/AccountForNetFlow",method:"POST",data:t})}},{key:"getAccountForShopping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Shopping/AccountForShopping",method:"POST",data:t})}}]),t}(),ie=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.dishStatistic={},t.netFlowStatistic={},t.shoppingStatistic={},t}return Object(f["a"])(a,[{key:"mounted",value:function(){this.getAccountForDish(),this.getAccountForNetFlow(),this.getAccountForShopping()}},{key:"getAccountForDish",value:function(){var t=this;ne.getAccountForDish({}).then((function(e){"200"==e.code?t.$refs.dishStatisticChart.renderCharts(e.data):t.$toast("获取数据失败!")}))}},{key:"getAccountForNetFlow",value:function(){var t=this;ne.getAccountForNetFlow({}).then((function(e){"200"==e.code?t.$refs.netFlowStatisticChart.renderCharts(e.data):t.$toast("获取数据失败!")}))}},{key:"getAccountForShopping",value:function(){var t=this;ne.getAccountForShopping({}).then((function(e){"200"==e.code?t.$refs.shoppingStatisticChart.renderCharts(e.data):t.$toast("获取数据失败!")}))}}]),a}(p["c"]);ie=Object(v["a"])([Object(p["a"])({name:"CrewCatering",components:{CrewStatisticChart:se}})],ie);var ce=ie,re=ce,oe=(a("bc0d"),Object(C["a"])(re,Yt,Jt,!1,null,"3e3eb476",null)),le=oe.exports,ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-income-statistics"},[a("div",{staticClass:"top-ctn"},[a("div",{staticClass:"back-ctn",on:{click:function(e){return t.stepBack()}}},[a("i",{staticClass:"icon icon-back"}),a("span",[t._v(" 返回 ")])]),t.layoutInfo?a("div",{staticClass:"class-bar-ctn"},t._l(t.tabList,(function(e,s){return a("div",{key:s,staticClass:"bar-item",class:{active:t.active==e.value,hasNewMessage:!0},on:{click:function(a){return t.scrollToSection(e.value)}}},[a("span",{staticClass:"label"},[t._v(t._s(e.name))]),t.messageCount[e.value]>0?a("span",{staticClass:"message-count"},[t._v(t._s(t.messageCount[e.value]))]):t._e()])})),0):t._e()]),a("div",{ref:"contentCtn",staticClass:"content-ctn"},[t.layoutInfo?a("div",{staticClass:"flight-layout-ctn",style:t.calcContentStyle(t.layoutInfo)},t._l(t.layoutInfo.sectionArr,(function(e,s){return a("section",{key:s,ref:"section"+t.layoutInfo.seatType.valueArr[s],refInFor:!0,staticClass:"section-ctn"},[a("div",{staticClass:"section-title"},[t._v(" "+t._s(t.layoutInfo.seatType.valueToName[t.layoutInfo.seatType.valueArr[s]])+" ")]),a("div",{staticClass:"section-content"},t._l(e,(function(e,s){return a("section",{key:s,staticClass:"row-ctn"},t._l(e,(function(e,s){return a("div",{key:s,staticClass:"col-ctn"},t._l(e,(function(e,s){return a("h6",{key:s,staticClass:"seat-ctn",class:{hasNewMessage:!!t.seatMessageMap[e.UserId],disabled:!e.UserId},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.clickSeatItem(e)}}},[a("span",[t._v(" "+t._s(e.Name)+" ")]),a("i",{staticClass:"icon icon-seat"}),t.seatMessageMap[e.UserId]?a("div",{staticClass:"seat-message-count"},[t._v(" "+t._s(t.seatMessageMap[e.UserId].total)+" ")]):t._e(),t.seatMessageMap[e.UserId]&&e.UserId==t.showTipUserId?a("div",{staticClass:"message-tip"},[a("div",{staticClass:"item-left"},[t._v(" "+t._s(e.Name)+" ")]),a("div",{staticClass:"item-right"},t._l(t.seatMessageMap[e.UserId].message,(function(s,n){return a("div",{key:n,staticClass:"message-ctn"},[a("span",{staticClass:"message-txt"},[t._v(t._s(s.content))]),a("span",{staticClass:"read-btn",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.goToChat(e)}}},[t._v("go")])])})),0),a("div",{staticClass:"triangle-ctn"})]):t._e()])})),0)})),0)})),0)])})),0):t._e()]),t.curUserId?a("crew-chat",{attrs:{curUserId:t.curUserId},on:{close:function(e){t.curUserId=""}}}):t._e()],1)},fe=[],de=(a("b64b"),a("96cf"),a("1da1")),he=function(){function t(){Object(u["a"])(this,t)}return Object(f["a"])(t,null,[{key:"getFlightSeatInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Crm/SeatInfo",method:"GET",data:t})}},{key:"getSeatMessageInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Message/SeatMessageInfo",method:"POST",data:t})}},{key:"getAirBusMessage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Message/GtAirBusMessage",method:"POST",data:t})}},{key:"sendToUser",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Message/SendToUser",method:"POST",data:t})}},{key:"readAirBusMessage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Message/ReadAirBusMessage",method:"POST",data:t})}},{key:"getUserMessageByUserIdArr",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(gt["a"])({url:"/v1/api/Message/getUserMessageByUserIdArr",method:"POST",data:t})}}]),t}(),ve=function(){function t(e){Object(u["a"])(this,t),this.layoutInfo={},this.calcSeatArr(e)}return Object(f["a"])(t,[{key:"calcSeatArr",value:function(t){var e={seatType:{valueArr:[],valueToName:{}},seatTypeRow:{},sectionMap:{},seatTypeMap:{},userSeatTypeMap:{}};t.forEach((function(t,a){t.UserId&&(e.userSeatTypeMap[t.UserId]=t.SeatType),e.seatType.valueToName[t.SeatType]||(e.seatType.valueToName[t.SeatType]="座位类型"+t.SeatType,e.seatType.valueArr.push(t.SeatType),e.seatTypeMap[t.SeatType]={},e.seatTypeRow[t.SeatType]=[]),e.sectionMap[t.SeatType]||(e.sectionMap[t.SeatType]={}),e.sectionMap[t.SeatType][t.Row]||(e.sectionMap[t.SeatType][t.Row]={}),e.sectionMap[t.SeatType][t.Row][t.Col]||(e.sectionMap[t.SeatType][t.Row][t.Col]={}),e.sectionMap[t.SeatType][t.Row][t.Col][t["col-number"]]||(e.sectionMap[t.SeatType][t.Row][t.Col][t["col-number"]]=t),e.seatTypeMap[t.SeatType][t.Id]=t}));var a=[];e.seatType.valueArr.forEach((function(t,s){var n=[];Object.keys(e.sectionMap[t]).forEach((function(a,s){e.seatTypeRow[t].push(a);var i=[];Object.keys(e.sectionMap[t][a]).forEach((function(s,n){var c=[];Object.keys(e.sectionMap[t][a][s]).forEach((function(n,i){c.push(e.sectionMap[t][a][s][n])})),i.push(c)})),n.push(i)})),a.push(n)})),e.sectionArr=a,e.maxSeatLen=this.calcMaxSeatLen(e),this.layoutInfo=e}},{key:"calcMaxSeatLen",value:function(t){var e={1:1,2:1,3:1},a=0;return t.sectionArr.forEach((function(s,n){var i=0,c=e[t.seatType.valueArr[n]];s.forEach((function(t,e){var a=0;t.forEach((function(t,e){a+=t.length}));var s=a+(t.length-1)*c;s>i&&(i=s)})),i>a&&(a=i)})),a}},{key:"getLayoutInfo",value:function(){return this.layoutInfo}}]),t}(),pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"crew-chat"},[a("div",{staticClass:"top-ctn"},[a("div",{staticClass:"back-ctn",on:{click:function(e){return t.stepToLayout()}}},[a("i",{staticClass:"icon icon-back"}),a("span",[t._v("返回")])])]),a("div",{staticClass:"content-ctn"},[a("div",{staticClass:"content-ctt"},[a("div",{staticClass:"aside-ctn"},t._l(t.messageUserList,(function(e,s){return a("van-swipe-cell",{key:s,staticClass:"mysong-swipe-item",on:{hello:function(e){return t.playSong(s)}},scopedSlots:t._u([{key:"right",fn:function(){return[a("div",{staticClass:"delete-btn"},[a("i",{staticClass:"icon icon-trash",on:{click:function(a){return t.deleteUser(s,e)}}})])]},proxy:!0}],null,!0)},[a("div",{staticClass:"user-item",class:{active:t.activeUserId==e.Id},on:{click:function(a){return t.activeChat(e.Id)}}},[a("div",{staticClass:"heade-img"},[t._v(t._s(e.NickName))]),a("div",{staticClass:"info-ctn"},[a("div",{staticClass:"info-top-ctn"},[a("span",[t._v(t._s(e.SeatNumber))]),a("span",[t._v(t._s(e.created_time))])]),a("p",{staticClass:"info-bottom-ctm"},[t._v(t._s(e.content))])]),t.newMsgCount[e.Id]&&t.newMsgCount[e.Id]>0?a("div",{staticClass:"message-count"},[t._v(" "+t._s(t.newMsgCount[e.Id])+" ")]):t._e()])])})),1),a("div",{staticClass:"main-ctn"},[a("div",{ref:"messageCtn",staticClass:"message-ctn"},[a("div",{staticClass:"inner-ctn"},[a("van-pull-refresh",{on:{refresh:t.loadReadData},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},t._l(t.messageList,(function(e,s){return a("div",{key:s,staticClass:"message-item-ctn"},[a("div",{staticClass:"message-item",class:{left:1==e.sendType,right:1!=e.sendType}},[1==e.sendType?a("div",[a("div",{staticClass:"heade-img"},[t._v(" "+t._s(e.fromNickName)+" ")]),a("div",{staticClass:"info-ctn"},[a("div",{staticClass:"info-top-ctn"},[a("span",[t._v(t._s(e.seatNumber))]),a("span",[t._v(t._s(t._f("dateFormate")(e.created_time,"hh:mm:ss")))])]),a("p",{staticClass:"info-bottom-ctm"},[t._v(t._s(e.content))])])]):t._e(),2==e.sendType?a("div",[a("div",{staticClass:"heade-img"},[t._v(" 我 ")]),a("div",{staticClass:"info-ctn"},[a("div",{staticClass:"info-top-ctn"},[a("span",[t._v(t._s(t._f("dateFormate")(e.created_time,"hh:mm:ss")))]),a("span")]),a("p",{staticClass:"info-bottom-ctm"},[t._v(t._s(e.content))])])]):t._e()])])})),0)],1)]),a("div",{staticClass:"oper-ctn"},[a("div",{staticClass:"input-ctn"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputMessage,expression:"inputMessage"}],attrs:{type:"text"},domProps:{value:t.inputMessage},on:{input:function(e){e.target.composing||(t.inputMessage=e.target.value)}}})]),a("div",{staticClass:"submit-ctn",on:{click:function(e){return t.sendMessage()}}},[t._v("发送")])])])])])])},ge=[],me=a("bc6b"),be=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.activeUserId="",t.userList=[],t.messageList=[],t.layoutList=[],t.active="firstClass",t.inputMessage="",t.socket=null,t.messageArr=[],t.newMsgCount={},t.messageUserList=[],t.beforeTime=(new Date).getTime(),t.pageSize=10,t.pageNumber=1,t.refreshing=!1,t.loading=!1,t.finished=!1,t.msgListener=null,t}return Object(f["a"])(a,[{key:"mounted",value:function(){var t=Object(de["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.getSeatMessageInfo(),this.activeChat(this.curUserId),this.startWebScoket(),this.handleUserList();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loadUnreadData",value:function(){localStorage.getItem("lang")}},{key:"deleteUser",value:function(t,e){var a=this;this.readAirBusMessage(e.Id,(function(){var e=me["a"].get("cacheUserList")||[];a.messageUserList.splice(t,1),e.splice(t,1),me["a"].set("cacheUserList",e),a.$forceUpdate()}))}},{key:"handleUserList",value:function(){var t=this,e=me["a"].get("cacheUserList")||[];he.getSeatMessageInfo().then((function(a){if("200"==a.code){a.data.reverse().forEach((function(t,a){var s=e.indexOf(t.UserId);s>-1?(e.splice(s,1),e.unshift(t.UserId)):e.unshift(t.UserId)}));var s=e.indexOf(t.activeUserId);s>-1?(e.splice(s,1),e.unshift(t.activeUserId)):e.unshift(t.activeUserId),he.getUserMessageByUserIdArr({messageUserList:e}).then((function(e){200==e.code&&(t.messageUserList=e.data,t.messageUserList.forEach((function(e,a){t.newMsgCount[e.Id]=e.count.length||0})))})),me["a"].set("cacheUserList",e)}}))}},{key:"loadReadData",value:function(){this.refreshing=!0,this.pageNumber=this.pageNumber+1,this.pageSize=10,this.getReadedAirBusMessage()}},{key:"activeChat",value:function(){var t=Object(de["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.activeUserId=e,this.pageSize=10,this.pageNumber=1,this.messageList=[],this.beforeTime=(new Date).getTime(),this.getReadedAirBusMessage(!0);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getReadedAirBusMessage",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];he.getAirBusMessage({userId:this.activeUserId,beforeTime:this.beforeTime,take:this.pageSize,skip:(this.pageNumber-1)*this.pageSize}).then((function(a){"200"==a.code?(e&&t.readAirBusMessage(t.activeUserId),a.data=a.data.reverse(),t.messageList=a.data.concat(t.messageList),t.scrollToTop(),t.loading=!1,t.refreshing=!1):(t.$toast("获取列表失败!"),t.loading=!1,t.refreshing=!1)}))}},{key:"beforeDestroy",value:function(){this.$globalEvent.$off("new_msg",this.msgListener)}},{key:"sendMessage",value:function(){var t=this;he.sendToUser({to:this.activeUserId,content:this.inputMessage}).then((function(e){"200"==e.code&&(t.inputMessage="",t.messageList.push(e.data),t.scrollToBottom())}))}},{key:"startWebScoket",value:function(){var t=this;this.msgListener=function(e){if(console.log("收到消息：chat"),"message"==e.type){e.from_user_id==t.activeUserId?(t.messageList.push(e),t.scrollToBottom(),t.readAirBusMessage(e.from_user_id)):(t.newMsgCount[e.from_user_id]=(t.newMsgCount[e.from_user_id]||0)+1,t.$forceUpdate());var a=me["a"].get("cacheUserList"),s=1==e.sendType?e.from_user_id:e.to_user_id,n=1==e.sendType?e.fromNickName:e.toNickName,i=a.indexOf(s);i<0?(a.unshift(s),t.messageUserList.unshift({Id:s,NickName:n,SeatNumber:e.seatNumber,created_time:e.created_time,content:e.content})):i>=1?(a.splice(i,1),a.unshift(s),t.messageUserList.splice(i,1),t.messageUserList.unshift({Id:s,NickName:n,SeatNumber:e.seatNumber,created_time:e.created_time,content:e.content})):(t.messageUserList[i].created_time=e.created_time,t.messageUserList[i].content=e.content),t.$forceUpdate(),me["a"].set("cacheUserList",a)}console.log("chat:msg")},this.$globalEvent.$on("new_msg",this.msgListener)}},{key:"scrollToBottom",value:function(){var t=this;this.$nextTick((function(){t.$refs.messageCtn.scrollTop=t.$refs.messageCtn.scrollHeight}))}},{key:"scrollToTop",value:function(){var t=this;this.$nextTick((function(){t.$refs.messageCtn.scrollTop=0}))}},{key:"readAirBusMessage",value:function(t,e){var a=this;he.readAirBusMessage({userId:t}).then((function(s){"200"==s.code&&(a.newMsgCount[t]=0,a.$forceUpdate(),e&&e())}))}},{key:"getSeatMessageInfo",value:function(){var t=this;he.getSeatMessageInfo().then((function(e){"200"==e.code&&(t.userList=e.data)}))}},{key:"stepToLayout",value:function(){this.$emit("close")}}]),a}(p["c"]);Object(v["a"])([Object(p["b"])()],be.prototype,"curUserId",void 0),be=Object(v["a"])([Object(p["a"])({name:"CrewChat",components:{}})],be);var Ce=be,ye=Ce,_e=(a("762b"),Object(C["a"])(ye,pe,ge,!1,null,"2075a3f4",null)),ke=_e.exports,we=function(t){Object(d["a"])(a,t);var e=Object(h["a"])(a);function a(){var t;return Object(u["a"])(this,a),t=e.apply(this,arguments),t.layoutList=[],t.active="firstClass",t.tabList=[],t.seatHeadLabelArr=["A","B","C","D","E","F","G"],t.seatMessageMap={},t.showTipUserId="",t.docClickHandle=null,t.showChatModal=!1,t.curUserId="",t.layoutInfo=null,t.pageSize=10,t.pageNumber=10,t.msgListener=null,t.messageCount={},t}return Object(f["a"])(a,[{key:"mounted",value:function(){var t=Object(de["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.docClickHandle=function(t){e.showTipUserId=""},document.addEventListener("click",this.docClickHandle),this.startWebScoket(),t.next=5,this.getFlightSeatInfo();case 5:return t.next=7,this.getSeatMessageInfo();case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"beforeDestroy",value:function(){document.removeEventListener("click",this.docClickHandle),this.$globalEvent.$off("new_msg",this.msgListener)}},{key:"calcContentStyle",value:function(t){var e=116;return{width:e*t.maxSeatLen/100+"rem"}}},{key:"stepBack",value:function(){this.$router.push({name:"crewCatering"})}},{key:"startWebScoket",value:function(){var t=this;this.msgListener=function(e){console.log("layout:msg"),Object.keys(t.messageCount).forEach((function(e,a){t.messageCount[e]=0})),t.getSeatMessageInfo()},this.$globalEvent.$on("new_msg",this.msgListener)}},{key:"scrollToSection",value:function(t){var e=this;this.active=t,this.$nextTick((function(){var a=e.$refs["section"+t][0].offsetTop;e.$refs.contentCtn.scrollTop=a}))}},{key:"clickSeatItem",value:function(t){t.UserId?this.seatMessageMap[t.UserId]?this.seatMessageMap[t.UserId]&&t.UserId==this.showTipUserId?this.showTipUserId="":this.seatMessageMap[t.UserId]&&t.UserId!=this.showTipUserId?this.showTipUserId=t.UserId:this.$toast("这是什么鬼!"):this.goToChat(t):this.showTipUserId=""}},{key:"goToChat",value:function(t){this.showTipUserId="",this.curUserId=t.UserId}},{key:"getFlightSeatInfo",value:function(){var t=this;he.getFlightSeatInfo().then((function(e){if("200"==e.code){var a=new ve(e.data),s=[];t.layoutInfo=a.getLayoutInfo(),t.layoutInfo.seatType.valueArr.forEach((function(e,a){0==a&&(t.active=e),s.push({name:t.layoutInfo.seatType.valueToName[e],value:e}),t.messageCount[e]=0})),t.tabList=s}}))}},{key:"getSeatMessageInfo",value:function(){var t=this;he.getSeatMessageInfo().then((function(e){var a={};"200"==e.code&&e.data.forEach((function(e,s){a[e.UserId]=e;var n=t.layoutInfo.userSeatTypeMap[e.UserId];t.messageCount[n]=t.messageCount[n]+e.total})),t.seatMessageMap=a}))}}]),a}(p["c"]);we=Object(v["a"])([Object(p["a"])({name:"CrewCatering",components:{CrewChat:ke}})],we);var Oe=we,je=Oe,Se=(a("1bc7"),Object(C["a"])(je,ue,fe,!1,null,"738bf9fd",null)),Le=Se.exports,Ie=[{path:"/crew/login",name:"crewLogin",component:k,children:[]},{path:"/crew/index",name:"crewIndex",component:V,children:[{path:"/crew/catering",name:"crewCatering",component:wt},{path:"/crew/datapackage",name:"crewDataPackage",component:Et},{path:"/crew/goods",name:"crewGoods",component:Vt},{path:"/crew/incomestatistics",name:"crewIncomeStatistics",component:le},{path:"/crew/cabinlayout",name:"crewCabinLayout",component:Le},{path:"/crew/chat",name:"crewChat",component:ke}]}],Me=Ie;s["a"].use(c["a"]);var Te=[{path:"/",name:"layout",component:r["a"],children:Object(i["a"])(Me)}],Ne=new c["a"]({routes:Te}),Ue=Ne,xe=a("0613"),Ae=a("4659"),$e=a("b970"),Fe=(a("157a"),a("a925")),Pe=a("343b");Ae["a"].forEach((function(t,e){s["a"].filter(t.name,t.handler)})),s["a"].use($e["a"]),s["a"].use(Pe["a"]),s["a"].use(Pe["a"],{lazyComponent:!0}),s["a"].use(Fe["a"]);var Ee=localStorage.getItem("lang")||"en",De=new Fe["a"]({locale:Ee,silentTranslationWarn:!0,messages:{zh:a("f9dc"),en:a("6a6a")}});localStorage.setItem("lang",Ee),s["a"].config.productionTip=!1,s["a"].prototype.$globalEvent=new s["a"],location.href.indexOf("localhost");var Be=new s["a"]({router:Ue,store:xe["a"],i18n:De,render:function(t){return t(n["a"])}}).$mount("#app");s["a"].config.host=Be},"762b":function(t,e,a){"use strict";var s=a("b441"),n=a.n(s);n.a},"78e5":function(t,e,a){},"7b52":function(t,e,a){"use strict";var s=a("54e9"),n=a.n(s);e["default"]=n.a},"83ff":function(t,e,a){},8519:function(t,e,a){"use strict";var s=a("571e"),n=a.n(s);n.a},8962:function(t,e,a){},"8a7e":function(t,e,a){},"8b21":function(t,e,a){},"9b95":function(t,e,a){"use strict";var s=a("4b0b"),n=a.n(s);e["default"]=n.a},aa0d:function(t,e,a){},b441:function(t,e,a){},b6a6:function(t,e,a){t.exports=a.p+"img/data_package_2.4051bcba.png"},bc0d:function(t,e,a){"use strict";var s=a("0770"),n=a.n(s);n.a},bd94:function(t,e,a){},c8cf:function(t,e,a){"use strict";var s=a("aa0d"),n=a.n(s);n.a},ce38:function(t,e,a){"use strict";var s=a("78e5"),n=a.n(s);n.a},d084:function(t,e,a){"use strict";var s=a("bd94"),n=a.n(s);n.a},d7ed:function(t,e,a){"use strict";var s=a("ed49"),n=a.n(s);n.a},e76f:function(t,e,a){"use strict";var s=a("8962"),n=a.n(s);n.a},ed49:function(t,e,a){},f2bc:function(t,e,a){"use strict";var s=a("83ff"),n=a.n(s);n.a},fc07:function(t,e,a){}});